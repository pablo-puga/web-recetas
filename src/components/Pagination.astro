---
import type { Page } from 'astro';

import { ADJACENT_PAGES } from '@lib/constants';

interface Props {
    page: Page;
}

const { page } = Astro.props;

const currentPage = page.currentPage;
const firstPage = 1;
const lastPage = page.lastPage;
---

<div>
    <div class="w-full flex justify-between text-sm mb-4 md:text-base lg:mb-5">
        <span class="info">
            Viendo {page.start + 1} - {page.end + 1} de {page.total}
        </span>
        <span class="info">PÃ¡gina {currentPage} de {lastPage}</span>
    </div>
    <slot />
    {
        page.total >= page.size && (
            <nav>
                <ul class="flex gap-1">
                    {page.url.prev && (
                        <li>
                            <a href={page.url.prev} class="pagination-item">
                                &lt; <span>Anterior</span>
                            </a>
                        </li>
                    )}
                    {currentPage - ADJACENT_PAGES > firstPage && (
                        <li>
                            <a href="/pagina/1">1</a>
                        </li>
                    )}
                    {currentPage - ADJACENT_PAGES > firstPage + 1 && (
                        <li>...</li>
                    )}
                    {Array.from({ length: page.lastPage }, (_, i) => i + 1)
                        .filter(
                            (p) =>
                                p >= currentPage - ADJACENT_PAGES &&
                                p <= currentPage + ADJACENT_PAGES,
                        )
                        .map((p) => (
                            <li>
                                <a
                                    class="pagination-item"
                                    aria-current={
                                        p === currentPage ? 'true' : 'false'
                                    }
                                    href={`/pagina/${p}`}
                                >
                                    {p}
                                </a>
                            </li>
                        ))}
                    {currentPage + ADJACENT_PAGES < lastPage - 1 && (
                        <li>...</li>
                    )}
                    {currentPage + ADJACENT_PAGES < lastPage && (
                        <li>
                            <a href={`/pagina/${lastPage}`}>{lastPage}</a>
                        </li>
                    )}
                    {page.url.next && (
                        <li>
                            <a href={page.url.next} class="pagination-item">
                                <span>Siguiente</span> &gt;
                            </a>
                        </li>
                    )}
                </ul>
            </nav>
        )
    }
</div>

<style>
    .info {
        @apply px-2 py-1 bg-theme-red-100 rounded-sm;
    }

    .pagination-item {
        &[aria-current='true'] {
            @apply font-bold;
        }
    }
</style>
